
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="fav_icon2.ico">
    <title>cbt.wisdomschools.org - PHYSICS    Exam</title>
    <script>
         // Disable back navigation
    history.pushState(null, null, location.href);
    window.onpopstate = function () {
        history.go(1);
    };

     let backClickCount = 0;
            let allowBack = false;

            history.pushState(null, null, location.href);

            window.onpopstate = function () {
                if (!allowBack) {
                    backClickCount++;

                    if (backClickCount >= 50) {
                        allowBack = true;
                        alert("You have tried 50 times. Going back now...");
                        history.back();
                        return;
                    }

                    showBackModal();
                }
            };

            function showBackModal() {
                document.getElementById("backModalOverlay").style.display = "flex";
                document.getElementById("passwordContainer").style.display = "none";
                document.getElementById("backPassword").value = "";
               
                document.getElementById("modalButtons").innerHTML = `
                    <button onclick="handleYes()" style="padding: 10px 20px; margin: 5px; border: none; border-radius: 5px; background: limegreen; color: white; font-size: 16px; cursor: pointer;">Yes</button>
                    <button onclick="closeBackModal()" style="padding: 10px 20px; margin: 5px; border: none; border-radius: 5px; background: crimson; color: white; font-size: 16px; cursor: pointer;">No</button>
                `;
            }

            function closeBackModal() {
                document.getElementById("backModalOverlay").style.display = "none";
                history.pushState(null, null, location.href);
            }

            function handleYes() {
                document.getElementById("passwordContainer").style.display = "block";
                document.getElementById("modalButtons").innerHTML = `
                    <button onclick="checkPassword()" style="padding: 10px 20px; margin: 5px; border: none; border-radius: 5px; background: limegreen; color: white; font-size: 16px; cursor: pointer;">Submit</button>
                    <button onclick="closeBackModal()" style="padding: 10px 20px; margin: 5px; border: none; border-radius: 5px; background: crimson; color: white; font-size: 16px; cursor: pointer;">Cancel</button>
                `;
            }

            function checkPassword() {
                const correctPassword = "admin123";
                const enteredPassword = document.getElementById("backPassword").value;

                if (enteredPassword === correctPassword) {
                    allowBack = true;
                    document.getElementById("backModalOverlay").style.display = "none";
                    history.back();
                } else {
                    alert("Incorrect password. Staying on this page.");
                    closeBackModal();
                }
            }
    </script>
</head>
         <div id="backModalOverlay" style="display: none; position: fixed; z-index: 9999; left: 0; top: 0; width: 100vw; height: 100vh; background: rgba(0, 0, 0, 0.8); color: #fff; font-family: Arial, sans-serif; justify-content: center; align-items: center; flex-direction: column;">
                <div id="backModal" style="background: #222; padding: 30px; border-radius: 10px; text-align: center; width: 90%; max-width: 400px;">
                    <p style="font-size: 18px; margin: 0 0 10px;">Do you really want to go back?</p>

                    <div id="passwordContainer" style="display: none;">
                        <p style="margin-top: 10px;">Enter password to go back:</p>
                        <input type="password" id="backPassword" placeholder="Enter password"
                            style="padding: 10px; width: 80%; margin-top: 10px; border-radius: 5px; border: none; font-size: 16px;">
                    </div>

                    <div id="modalButtons" style="margin-top: 20px;">
                        <button onclick="handleYes()" style="padding: 10px 20px; margin: 5px; border: none; border-radius: 5px; background: limegreen; color: white; font-size: 16px; cursor: pointer;">Yes</button>
                        <button onclick="closeBackModal()" style="padding: 10px 20px; margin: 5px; border: none; border-radius: 5px; background: crimson; color: white; font-size: 16px; cursor: pointer;">No</button>
                    </div>
                </div>
            </div>
                      

    <style>
        body {
            position: relative;
            z-index: 1;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f8f0;
        }
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('img/mainlogo.png') no-repeat center center;
            background-size: 300px 300px;
            opacity: 0.1;
            z-index: 0;
            pointer-events: none;
        }
        #logout-container {
            text-align: right;
            padding: 10px;
            background: #2c3e50;
        }
        #datetime {
            color: gold;
            font-size: 18px;
            font-weight: bold;
            text-align: center;
            margin: 10px 0;
        }
        #logout {
            background-color: red;
            color: white;
            border: none;
            padding: 8px 16px;
            cursor: pointer;
            font-size: 14px;
            border-radius: 5px;
        }
        #header {
            padding: 20px;
            background: linear-gradient(to right, purple, fuchsia);
            color: white;
            border-bottom: 5px solid #ff9800;
        }
        #logo img {
            max-width: 200px;
            height: auto;
            display: block;
            margin: 0 auto;
        }
        #student-info {
            margin-top: 20px;
            text-align: center;
        }
        #student-image {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            display: block;
            margin: 0 auto 10px;
            border: 3px solid white;
            background: #ddd;
        }
        #welcome-message {
            color: #ffeb3b;
            font-size: 24px;
            font-weight: bold;
            margin: 10px 0;
        }
        #userAnswerCount {
            position: fixed;
            top: 20px;
            left: 20px;
            background-color: rgba(0, 0, 0, 0.7);
            padding: 15px;
            border-radius: 8px;
            color: white;
            text-align: center;
            font-size: 16px;
            font-weight: bold;
            width: 200px;
            z-index: 100;
        }
        #answeredLabel {
            color: lime;
            font-size: 18px;
            font-weight: bold;
            margin: 5px 0;
        }
        #unansweredLabel {
            color: red;
            font-size: 18px;
            font-weight: bold;
            margin: 5px 0;
        }
        .container {
            margin: 20px auto;
            width: 80%;
            padding: 20px;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        #questionText {
            width: 98%;
            min-height: 100px;
            resize: none;
            padding: 15px;
            font-size: 18px;
            color: #333;
            background-color: #f9f9f9;
            border-radius: 5px;
            border: 1px solid #ddd;
            margin-bottom: 15px;
            font-family: Arial, "Segoe UI Symbol", "Apple Symbols", sans-serif;
        }
        .option-group {
            display: flex;
            align-items: center;
            margin: 10px 0;
            padding: 12px;
            background-color: #f5f5f5;
            border-radius: 5px;
            transition: background-color 0.3s;
        }
        .option-group:hover {
            background-color: #e8f5e8;
        }
        .option-group input {
            margin-right: 15px;
            transform: scale(1.3);
        }
        .option-group label {
            font-weight: bold;
            font-size: 16px;
            color: #333;
            font-family: Arial, "Segoe UI Symbol", "Apple Symbols", sans-serif;
        }
        .nav-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }
        .btn-cool {
            padding: 12px 25px;
            font-size: 16px;
            border: none;
            border-radius: 8px;
            background: #2e7d32;
            color: white;
            cursor: pointer;
            transition: background 0.3s;
            font-weight: bold;
        }
        .btn-cool:hover {
            background: #1b5e20;
        }
        .questionButtons {
            margin: 15px 0;
            text-align: center;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 5px;
        }
        .question-btn {
            margin: 3px;
            padding: 8px 12px;
            border-radius: 6px;
            border: 1px solid #444;
            cursor: pointer;
            font-weight: bold;
            background-color: #eee;
            min-width: 40px;
            transition: all 0.3s;
        }
        .question-btn:hover {
            background-color: #d0f0d0;
        }
        #timer {
            font-size: 24px;
            font-weight: bold;
            color: #e74c3c;
            text-align: center;
            margin: 10px 0;
            background-color: #f9f9f9;
            padding: 10px;
            border-radius: 5px;
            border: 2px solid #e74c3c;
        }
        .section-toggle {
            display: flex;
            justify-content: center;
            margin: 20px 0;
        }
        .section-btn {
            padding: 12px 24px;
            margin: 0 10px;
            font-size: 16px;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .section-btn.active {
            background-color: #2e7d32;
            color: white;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .section-btn:not(.active) {
            background-color: #e0e0e0;
            color: #333;
        }
        #theorySection {
            display: none;
            background: #fff9e6;
            color: #333;
            padding: 20px;
            border-radius: 8px;
            margin: 20px auto;
            width: 80%;
            border: 2px solid #ff9800;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        #theoryQuestionText {
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 15px;
            line-height: 1.6;
            padding: 15px;
            background-color: #fff;
            border-radius: 5px;
            border-left: 5px solid #ff9800;
            font-family: Arial, sans-serif;
        }
        #theoryAnswer {
            width: 100%;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #ccc;
            font-size: 16px;
            resize: vertical;
            min-height: 200px;
            font-family: Arial, sans-serif;
            margin-bottom: 15px;
        }
        .theory-nav-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        .theory-btn {
            padding: 10px 20px;
            font-size: 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
        }
        .theory-save-btn {
            background-color: #28a745;
            color: white;
        }
        .theory-save-btn:hover {
            background-color: #218838;
        }
        .theory-prev-btn, .theory-next-btn {
            background-color: #007bff;
            color: white;
        }
        .theory-prev-btn:hover, .theory-next-btn:hover {
            background-color: #0069d9;
        }
        .theory-submit-btn {
            background-color: #dc3545;
            color: white;
        }
        .theory-submit-btn:hover {
            background-color: #c82333;
        }
        .theory-status {
            text-align: center;
            margin: 10px 0;
            font-weight: bold;
            color: #333;
            padding: 10px;
            background-color: #e9ecef;
            border-radius: 5px;
        }
        .windows-activate {
            text-align: center;
            margin-top: 30px;
            color: #333;
            font-size: 14px;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            margin: 20px;
        }
        .exam-info {
            text-align: center;
            font-weight: bold;
            margin: 10px 0;
            color: #2c3e50;
            font-size: 18px;
        }
        /* Math symbols styling */
        sup, sub {
            font-size: 0.75em;
            line-height: 1;
        }
        sup {
            vertical-align: super;
        }
        sub {
            vertical-align: sub;
        }
        /* Theory Question Images */
        .theory-image-container {
            margin: 15px 0;
            text-align: center;
        }
        .theory-image-wrapper {
            display: inline-block;
            max-width: 100%;
            padding: 10px;
            background: white;
            border-radius: 8px;
            border: 1px solid #ddd;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .theory-question-image {
            max-width: 100%;
            max-height: 300px;
            height: auto;
            border-radius: 5px;
            display: block;
            margin: 0 auto;
            background: #f0f0f0;
            padding: 10px;
        }
        .image-caption {
            font-style: italic;
            color: #666;
            margin-top: 8px;
            font-size: 14px;
            text-align: center;
        }
        /* Objective question images */
        #questionImageContainer {
            text-align: center;
            margin: 15px 0;
        }
        .question-image {
            max-width: 100%;
            max-height: 250px;
            height: auto;
            border-radius: 5px;
            border: 1px solid #ddd;
            padding: 5px;
            background: white;
        }
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
    </style>
</head>
<body oncontextmenu="return false">
    <div id="header">
        <div id="logout-container">
            <button id="logout" onclick="logout()">Logout</button>
        </div>
        <div id="logo">
            <img src="img/mainlogo.png" alt="COLLEGE CBT PORTAL">
        </div>
        <div id="student-info">
            <center><strong>ATTENTION! CLICK ON SUBMIT BUTTON BEFORE YOUR TIME IS UP TO SAVE YOUR SCORE</strong></center>
            <center><p id="datetime"></p></center>
              <div id="welcome-message">
            <label id="usernameDisplay"></label>
        </div>
         <div class="student-info">
          <img id="userImage" src="img/default_user.jpg" alt="Student Image" style="width:120px; height:120px; border-radius:50%; border:3px solid #008000; display:block; margin:0 auto;">
      
          <h2 id="username">Student Name</h2>
           </div>

        <!--<img id="userImage" src="img/default_user.jpg" alt="Student Image" style="width:120px; height:120px; border-radius:50%; border:3px solid #008000; display:block; margin:0 auto;">
      
            <center><img id="userImage"><br><br></center>
             <img id="userImage" src="img/default_user.jpg" alt="Student Image">
            <center>Hello: <span id="userName"></span></center>
        </div>-->

    
        <center><h3>WISDOM FOUNDATIONS INTERNATIONAL SCHOOLS ADO EKITI </h3></center> 
        <center><h3>FIRST TERM EXAMINATION 2025/2026 ACADEMIC SESSION</h3></center>
       
        <!-- SECTION TOGGLE BUTTONS -->
        <div class="section-toggle">
            <button id="objectivesBtn" class="section-btn active" onclick="showSection('objectives')">OBJECTIVE QUESTIONS</button>
            <button id="theoryBtn" class="section-btn" onclick="showSection('theory')">THEORY QUESTIONS</button>
        </div>
       
        <div class="exam-info">
            Exam: <span id="examInfo" style="color: lime;">   PHYSICS    - SS3 (FIRST TERM)</span>
        </div>
       
        <div id="timer"></div>
    </div>
   
    <!-- OBJECTIVES SECTION -->
    <div id="objectivesSection">
        <div class="container">
            <h5 style="color: #d35400; text-align: center;">INSTRUCTIONS: READ THE QUESTIONS CAREFULLY BEFORE YOU CHOOSE YOUR ANSWER</h5>
            <div class="scroll-container">
                <div id="questionText"></div>
            </div>
           
            <div id="questionImageContainer"></div>
           
            <div class="option-group">
                <label class="option"><strong>A.</strong><input type="radio" name="option" value="A"> <span id="optA"></span></label>
            </div>
            <div class="option-group">
                <label class="option"><strong>B.</strong><input type="radio" name="option" value="B"> <span id="optB"></span></label>
            </div>
            <div class="option-group">
                <label class="option"><strong>C.</strong><input type="radio" name="option" value="C"> <span id="optC"></span></label>
            </div>
            <div class="option-group">
                <label class="option"><strong>D.</strong><input type="radio" name="option" value="D"> <span id="optD"></span></label>
            </div>
        </div>
       
        <div class="nav-buttons">
            <button onclick="prevQuestion()" class="btn-cool">Previous</button>
            <button onclick="nextQuestion()" class="btn-cool">Next</button>
            <button onclick="submitExam()" class="btn-cool">Submit Objectives</button>
        </div>
       
        <!-- Question navigation buttons -->
        <div class="container">
            <div id="questionButtons" class="questionButtons"></div>
        </div>
    </div>
   
    <!-- THEORY SECTION -->
    <div id="theorySection">
        <h3 style="text-align: center; color: #d35400; margin-bottom: 20px;">THEORY QUESTIONS SECTION</h3>
        <div class="theory-status" id="theoryStatus">
            Question 1 of 5 | Saved: 0/5
        </div>
        <div id="theoryQuestionContainer">
            <p id="theoryQuestionText">Loading theory questions...</p>
            <div id="theoryImageContainer"></div>
            <textarea id="theoryAnswer" rows="8" placeholder="Write your detailed answer here..."></textarea>
            <div class="theory-nav-buttons">
                <button onclick="prevTheoryQuestion()" class="theory-btn theory-prev-btn">Previous</button>
                <button onclick="saveTheoryAnswer()" class="theory-btn theory-save-btn">Save Answer</button>
                <button onclick="nextTheoryQuestion()" class="theory-btn theory-next-btn">Next</button>
                <button onclick="submitTheoryExam()" class="theory-btn theory-submit-btn">Submit Theory</button>
            </div>
        </div>
    </div>
   
    <div id="userAnswerCount">
        <p id="answeredLabel">Answered: 0/5</p>
        <p id="unansweredLabel">Unanswered: 5/5</p>
    </div>
   
    <div class="windows-activate">
        <p> &copy; cbt.wisdomschools.org</p>
    </div>

    <script>
           // Get stored username and image from sessionStorage
       
            
    
        // ================== STATIC QUESTIONS DATA ==================
   const staticObjectivesQuestions = [
                                            {
      "id": 1,
      "question": "Which of the following is a scalar quantity?",
      "options": {
        "A": "Velocity",
        "B": "Force",
        "C": "Energy",
        "D": "Momentum"
      },
      "answer": "C",
      "image": ""
    },
    {
      "id": 2,
      "question": "The vector having magnitude 1 is called",
      "options": {
        "A": "Null vector",
        "B": "Unit vector",
        "C": "Position vector",
        "D": "Negative vector"
      },
      "answer": "B",
      "image": ""
    },
    {
      "id": 3,
      "question": "If →A + →B = →C and A + B = C, then vector →C is",
      "options": {
        "A": "Perpendicular to →A + →B",
        "B": "Parallel to →A + →B",
        "C": "Zero",
        "D": "None"
      },
      "answer": "B",
      "image": ""
    },
    {
      "id": 4,
      "question": "The dot product of two perpendicular vectors is",
      "options": {
        "A": "Maximum",
        "B": "Zero",
        "C": "Unity",
        "D": "Infinite"
      },
      "answer": "B",
      "image": ""
    },
    {
      "id": 5,
      "question": "The magnitude of the resultant of two equal vectors acting at 120° is",
      "options": {
        "A": "Zero",
        "B": "2a",
        "C": "a",
        "D": "a/√3"
      },
      "answer": "C",
      "image": ""
    },
    {
      "id": 6,
      "question": "Newton’s first law is also known as",
      "options": {
        "A": "Law of inertia",
        "B": "Law of action-reaction",
        "C": "Law of force",
        "D": "All"
      },
      "answer": "A",
      "image": ""
    },
    {
      "id": 7,
      "question": "The acceleration produced in a body is proportional to",
      "options": {
        "A": "Net force",
        "B": "Mass",
        "C": "Velocity",
        "D": "Displacement"
      },
      "answer": "A",
      "image": ""
    },
    {
      "id": 8,
      "question": "A body of mass 5 kg is acted upon by a force of 20 N. Its acceleration is",
      "options": {
        "A": "100 m/s²",
        "B": "4 m/s²",
        "C": "25 m/s²",
        "D": "1 m/s²"
      },
      "answer": "B",
      "image": ""
    },
    {
      "id": 9,
      "question": "Action and reaction forces act on",
      "options": {
        "A": "Same body",
        "B": "Different bodies",
        "C": "Same direction",
        "D": "Perpendicular"
      },
      "answer": "B",
      "image": ""
    },
    {
      "id": 10,
      "question": "The equation v = u + at is",
      "options": {
        "A": "First equation of motion",
        "B": "Second",
        "C": "Third",
        "D": "None"
      },
      "answer": "B",
      "image": ""
},
 {
      "id": 11,
      "question": "The equation s = ut + ½ at² represents",
      "options": {
        "A": "Second equation",
        "B": "First",
        "C": "Third",
        "D": "Fourth"
      },
      "answer": "A",
      "image": ""
    },
    {
      "id": 12,
      "question": "A body falling freely under gravity has acceleration",
      "options": {
        "A": "Zero",
        "B": "9.8 m/s²",
        "C": "9.8 m/s² downward",
        "D": "Variable"
      },
      "answer": "C",
      "image": ""
    },
    {
      "id": 13,
      "question": "In projectile motion, the horizontal component of velocity",
      "options": {
        "A": "Increases",
        "B": "Decreases",
        "C": "Remains constant",
        "D": "First increases then decreases"
      },
      "answer": "C",
      "image": ""
    },
    {
      "id": 14,
      "question": "Time of flight of a projectile projected at angle θ is",
      "options": {
        "A": "(2u sinθ)/g",
        "B": "(u sinθ)/g",
        "C": "(2u sinθ)/g",
        "D": "(u cosθ)/g"
      },
      "answer": "C",
      "image": ""
    },
    {
      "id": 15,
      "question": "Maximum range of a projectile is obtained when angle of projection is",
      "options": {
        "A": "30°",
        "B": "60°",
        "C": "45°",
        "D": "90°"
      },
      "answer": "C",
      "image": ""
    },
    {
      "id": 16,
      "question": "At the highest point of a projectile, its velocity is",
      "options": {
        "A": "Zero",
        "B": "Maximum",
        "C": "u cosθ",
        "D": "u sinθ"
      },
      "answer": "C",
      "image": ""
    },
    {
      "id": 17,
      "question": "The trajectory of a projectile is",
      "options": {
        "A": "Straight line",
        "B": "Parabola",
        "C": "Circle",
        "D": "Hyperbola"
      },
      "answer": "B",
      "image": ""
    },
    {
      "id": 18,
      "question": "Mechanical advantage of an ideal machine is",
      "options": {
        "A": "Less than 1",
        "B": "Equal to 1",
        "C": "Greater than 1",
        "D": "Zero"
      },
      "answer": "B",
      "image": ""
    },
    {
      "id": 19,
      "question": "Velocity ratio of a single movable pulley is",
      "options": {
        "A": "1",
        "B": "2",
        "C": "3",
        "D": "4"
      },
      "answer": "B",
      "image": ""
    },
    {
      "id": 20,
      "question": "Efficiency of a machine is always",
      "options": {
        "A": "100%",
        "B": "Less than 100%",
        "C": "Greater than 100%",
        "D": "Zero"
      },
      "answer": "B",
      "image": ""
    },
    {
      "id": 21,
      "question": "Inclined plane is used to",
      "options": {
        "A": "Reduce effort",
        "B": "Increase effort",
        "C": "Multiply force only",
        "D": "None"
      },
      "answer": "A",
      "image": ""
    },
    {
      "id": 22,
      "question": "The distance between two consecutive crests is called",
      "options": {
        "A": "Frequency",
        "B": "Time period",
        "C": "Wavelength",
        "D": "Amplitude"
      },
      "answer": "C",
      "image": ""
    },
    {
      "id": 23,
      "question": "Speed of wave =",
      "options": {
        "A": "Frequency × Time period",
        "B": "Frequency × Wavelength",
        "C": "Wavelength / Time period",
        "D": "Amplitude × Frequency"
      },
      "answer": "B",
      "image": ""
    },
    {
      "id": 24,
      "question": "Sound cannot travel through",
      "options": {
        "A": "Air",
        "B": "Water",
        "C": "Steel",
        "D": "Vacuum"
      },
      "answer": "D",
      "image": ""
    },
    {
      "id": 25,
      "question": "In a transverse wave, particles vibrate",
      "options": {
        "A": "Parallel to wave direction",
        "B": "Perpendicular to wave direction",
        "C": "In circles",
        "D": "Randomly"
      },
      "answer": "B",
      "image": ""
    },
    {
      "id": 26,
      "question": "The SI unit of frequency is",
      "options": {
        "A": "Meter",
        "B": "Second",
        "C": "Hertz",
        "D": "Newton"
      },
      "answer": "C",
      "image": ""
    },
    {
      "id": 27,
      "question": "The speed of sound in air at 20°C is approximately",
      "options": {
        "A": "280 m/s",
        "B": "340 m/s",
        "C": "400 m/s",
        "D": "500 m/s"
      },
      "answer": "B",
      "image": ""
    },
    {
      "id": 28,
      "question": "Echo is caused due to",
      "options": {
        "A": "Refraction",
        "B": "Diffraction",
        "C": "Reflection",
        "D": "Interference"
      },
      "answer": "C",
      "image": ""
    },
    {
      "id": 29,
      "question": "The sensation of pitch depends on",
      "options": {
        "A": "Amplitude",
        "B": "Frequency",
        "C": "Speed",
        "D": "Wavelength"
      },
      "answer": "B",
      "image": ""
    },
    {
      "id": 30,
      "question": "Loudness of sound depends on",
      "options": {
        "A": "Amplitude",
        "B": "Frequency",
        "C": "Speed",
        "D": "Medium"
      },
      "answer": "A",
      "image": ""
    },
    {
      "id": 31,
      "question": "The audible frequency range for human ear is",
      "options": {
        "A": "Less than 20 Hz",
        "B": "20 Hz to 20,000 Hz",
        "C": "More than 20 kHz",
        "D": "0 to 10 Hz"
      },
      "answer": "B",
      "image": ""
    },
    {
      "id": 32,
      "question": "Ultrasonic waves have frequency",
      "options": {
        "A": "Below 20 Hz",
        "B": "Above 20 kHz",
        "C": "Between 20–20000 Hz",
        "D": "1 MHz only"
      },
      "answer": "B",
      "image": ""
    },
    {
      "id": 33,
      "question": "The speed of sound is maximum in",
      "options": {
        "A": "Air",
        "B": "Water",
        "C": "Steel",
        "D": "Vacuum"
      },
      "answer": "C",
      "image": ""
    },
    {
      "id": 34,
      "question": "The minimum distance required to hear a distinct echo (speed = 340 m/s) is",
      "options": {
        "A": "10 m",
        "B": "17 m",
        "C": "34 m",
        "D": "50 m"
      },
      "answer": "B",
      "image": ""
    },
    {
      "id": 35,
      "question": "The angle of incidence is equal to the angle of reflection. This is",
      "options": {
        "A": "Law of reflection",
        "B": "Law of refraction",
        "C": "Dispersion",
        "D": "Diffraction"
      },
      "answer": "A",
      "image": ""
    },
    {
      "id": 36,
      "question": "The image formed by a plane mirror is",
      "options": {
        "A": "Real, inverted",
        "B": "Virtual, erect",
        "C": "Real, erect",
        "D": "Virtual, inverted"
      },
      "answer": "B",
      "image": ""
    },
    {
      "id": 37,
      "question": "When light goes from air to glass, its speed",
      "options": {
        "A": "Increases",
        "B": "Decreases",
        "C": "Remains same",
        "D": "Becomes zero"
      },
      "answer": "B",
      "image": ""
    },
    {
      "id": 38,
      "question": "The refractive index of glass is 1.5. This means light travels in glass",
      "options": {
        "A": "1.5 times faster",
        "B": "1.5 times slower than in vacuum",
        "C": "Same speed",
        "D": "1.5 times faster"
      },
      "answer": "B",
      "image": ""
    },
    {
      "id": 39,
      "question": "The splitting of white light into seven colours is called",
      "options": {
        "A": "Reflection",
        "B": "Refraction",
        "C": "Dispersion",
        "D": "Interference"
      },
      "answer": "C",
      "image": ""
    },
    {
      "id": 40,
      "question": "Myopia is corrected by using",
      "options": {
        "A": "Convex lens",
        "B": "Concave lens",
        "C": "Cylindrical lens",
        "D": "Bifocal lens"
      },
      "answer": "B",
      "image": ""
    },
    {
      "id": 41,
      "question": "The power of a lens is +2D. It is",
      "options": {
        "A": "Convex",
        "B": "Concave",
        "C": "Plano-convex",
        "D": "Cannot say"
      },
      "answer": "A",
      "image": ""
    },
    {
      "id": 42,
      "question": "The focal length of a lens of power –5D is",
      "options": {
        "A": "5 cm",
        "B": "50 cm",
        "C": "–20 cm",
        "D": "20 cm"
      },
      "answer": "C",
      "image": ""
    },
    {
      "id": 43,
      "question": "Rainbow is formed due to",
      "options": {
        "A": "Reflection only",
        "B": "Refraction only",
        "C": "Dispersion, refraction and total internal reflection",
        "D": "Diffraction"
      },
      "answer": "C",
      "image": ""
    },
    {
      "id": 44,
      "question": "The SI unit of heat is",
      "options": {
        "A": "Calorie",
        "B": "Joule",
        "C": "Watt",
        "D": "Kelvin"
      },
      "answer": "B",
      "image": ""
    },
    {
      "id": 45,
      "question": "1 calorie =",
      "options": {
        "A": "4.186 J",
        "B": "4186 J",
        "C": "0.4186 J",
        "D": "1 J"
      },
      "answer": "A",
      "image": ""
    },
    {
      "id": 46,
      "question": "Specific heat of water is",
      "options": {
        "A": "4200 J/kg·K",
        "B": "4186 J/kg·K",
        "C": "2100 J/kg·K",
        "D": "900 J/kg·K"
      },
      "answer": "B",
      "image": ""
    },
    {
      "id": 47,
      "question": "Latent heat of vaporization of water is",
      "options": {
        "A": "336 J/g",
        "B": "2260 J/g",
        "C": "540 cal/g",
        "D": "Both B & C"
      },
      "answer": "D",
      "image": ""
    },
    {
      "id": 48,
      "question": "Heat required to convert 1 g of ice at 0°C to steam at 100°C is",
      "options": {
        "A": "100 cal",
        "B": "616 cal",
        "C": "716 cal",
        "D": "540 cal"
      },
      "answer": "C",
      "image": ""
    },
    {
      "id": 49,
      "question": "The principle of calorimetry is",
      "options": {
        "A": "Heat lost = Heat gained",
        "B": "Heat lost > Heat gained",
        "C": "Heat created",
        "D": "Heat destroyed"
      },
      "answer": "A",
      "image": ""
    },
    {
      "id": 50,
      "question": "When ice melts, its temperature",
      "options": {
        "A": "Increases",
        "B": "Decreases",
        "C": "Remains constant",
        "D": "First increases then constant"
      },
      "answer": "C",
      "image": ""
    },
    {
      "id": 51,
      "question": "The acceleration due to gravity on moon is g/6. The weight of a body on moon will be",
      "options": {
        "A": "Same",
        "B": "1/6th",
        "C": "6 times",
        "D": "Zero"
      },
      "answer": "B",
      "image": ""
    },
    {
      "id": 52,
      "question": "The mirror used in vehicles as rear-view mirror is",
      "options": {
        "A": "Concave",
        "B": "Convex",
        "C": "Plane",
        "D": "Parabolic"
      },
      "answer": "B",
      "image": ""
    },
    {
      "id": 53,
      "question": "The velocity of sound increases with increase in",
      "options": {
        "A": "Pressure",
        "B": "Temperature",
        "C": "Humidity",
        "D": "All"
      },
      "answer": "B",
      "image": ""
    },
    {
      "id": 54,
      "question": "The wavelength of audible sound is",
      "options": {
        "A": "1 cm to 1 m",
        "B": "1.7 cm to 17 m",
        "C": "17 m to 34 m",
        "D": "0.1 mm to 1 mm"
      },
      "answer": "B",
      "image": ""
    },
    {
      "id": 55,
      "question": "The relation between velocity (v), frequency (f) and wavelength (λ) is",
      "options": {
        "A": "v = fλ",
        "B": "v = fλ",
        "C": "f = vλ",
        "D": "λ = vf"
      },
      "answer": "B",
      "image": ""
    },
    {
      "id": 56,
      "question": "The unit of power of a lens is",
      "options": {
        "A": "Watt",
        "B": "Joule",
        "C": "Diopter",
        "D": "Meter"
      },
      "answer": "C",
      "image": ""
    },
    {
      "id": 57,
      "question": "In a simple pendulum, the time period depends on",
      "options": {
        "A": "Mass",
        "B": "Amplitude",
        "C": "Length",
        "D": "Material"
      },
      "answer": "C",
      "image": ""
    },
    {
      "id": 58,
      "question": "The magnitude of gravitational force between two bodies is F. If distance is doubled, new force is",
      "options": {
        "A": "4F",
        "B": "2F",
        "C": "F/4",
        "D": "F/2"
      },
      "answer": "C",
      "image": ""
    },
    {
      "id": 59,
      "question": "The image formed by a convex lens can be",
      "options": {
        "A": "Virtual only",
        "B": "Real only",
        "C": "Both real and virtual",
        "D": "Neither"
      },
      "answer": "C",
      "image": ""
    },
    {
      "id": 60,
      "question": "When a ray of light enters from air to water, its wavelength",
      "options": {
        "A": "Increases",
        "B": "Decreases",
        "C": "Remains same",
        "D": "Becomes zero"
      },
      "answer": "B",
      "image": ""
    }
];

 const staticTheoryQuestions = [
              {
      "id": 1,
      "question": "Distinguish clearly between a progressive (travelling) wave and a standing (stationary) wave in terms of (i) energy transfer, (ii) phase difference between particles, (iii) amplitude variation along the medium, and (iv) node/antinode formation. Derive the equation of a standing wave formed by superposition of two identical progressive waves travelling in opposite directions.",
      "marks": "",
      "image": ""
    },
    {
      "id": 2,
      "question": "Two sound waves of frequencies 512 Hz and 516 Hz are sounded simultaneously. (a) Explain the phenomenon of beats and calculate the beat frequency. (b) Derive the expression for the resultant intensity as a function of time. (c) At what phase difference between the two waves will the intensity be (i) maximum and (ii) minimum?",
      "marks": "",
      "image": ""
    },
    {
      "id": 3,
      "question": "An open organ pipe and a closed organ pipe have the same length L and both are sounding their fundamental notes. (a) Draw neat diagrams showing the pressure and displacement variations for the fundamental mode in both pipes. (b) Prove that the fundamental frequency of the open pipe is twice that of the closed pipe. (c) If the speed of sound is 340 m/s and L = 0.5 m, calculate the fundamental frequencies of both pipes.",
      "marks": "",
      "image": ""
    },
    {
      "id": 4,
      "question": "Derive the general Doppler formula for the observed frequency when (i) source is moving towards the observer, (ii) observer is moving towards the source, (iii) both are moving (same or opposite directions). Clearly state the sign convention used. Also explain why no Doppler effect is observed when the motion of source/observer is perpendicular to the line joining them.",
      "marks": "",
      "image": ""
    },
    {
      "id": 5,
      "question": "In Young’s double-slit experiment, monochromatic light of wavelength 600 nm falls on two slits 0.3 mm apart. The interference pattern is observed on a screen 1.5 m away. (a) Derive the condition for bright and dark fringes. (b) Find the distance between the central bright fringe and the 4th bright fringe. (c) If one slit is covered, explain what happens to the pattern and why the average intensity increases four times.",
      "marks": "",
      "image": ""
    },
    {
      "id": 6,
      "question": "(a) Distinguish between Fresnel and Fraunhofer diffraction with examples. (b) Derive the condition for the central maxima, secondary maxima, and minima in single-slit Fraunhofer diffraction. (c) A slit of width 0.2 mm is illuminated by light of wavelength 550 nm. Find the angular width of the central maximum on a screen.",
      "marks": "",
      "image": ""
    },
    {
      "id": 7,
      "question": "(a) Explain with diagrams how unpolarized light can be polarized by (i) reflection (Brewster’s law) and (ii) double refraction. (b) State and prove Brewster’s law. (c) Unpolarized light is incident on a polarizer–analyser pair. The analyser is rotated. Show that the transmitted intensity varies as cos²θ (Malus’ law).",
      "marks": "",
      "image": ""
    },
    {
      "id": 8,
      "question": "Compare Huygens’ wave theory and Newton’s corpuscular theory of light with respect to their explanation of: (i) rectilinear propagation, (ii) reflection and refraction, (iii) interference and diffraction, (iv) speed of light in denser medium. State which phenomena decisively proved the wave nature of light.",
      "marks": "",
      "image": ""
    },
    {
      "id": 9,
      "question": "(a) Explain the phenomenon of dispersion of white light through a prism. Why does violet light deviate the most? (b) Distinguish between Rayleigh scattering and Raman scattering. (c) Using Rayleigh scattering law (I ∝ 1/λ⁴), explain why the sky appears blue during the day and reddish at sunset.",
      "marks": "",
      "image": ""
    },
    {
      "id": 10,
      "question": "(a) Explain the phenomenon of sonoluminescence (light emission when sound waves of very high intensity are passed through a liquid). (b) What extreme physical conditions are believed to be created inside the collapsing bubble? (c) How does this phenomenon provide evidence for the interconversion between mechanical (sound) energy and electromagnetic (light) energy at microscopic scales?",
      "marks": "",
      "image": ""
    }
    
];
        // ================== APPLICATION VARIABLES ==================
        let questions = [];
        let currentQuestion = 0;
        let userAnswers = [];
        let theoryQuestions = [];
        let currentTheory = 0;
        let theoryAnswers = [];
        let currentSection = 'objectives';
       
        // ================== INITIALIZATION ==================
        window.onload = function () {
            // Extract exam info from the page
            const examInfoElement = document.getElementById('examInfo');
            if (examInfoElement) {
                const examInfoText = examInfoElement.textContent;
                // Parse the text to extract subject and class
                // This is a simple example - adjust based on your actual text format
                localStorage.setItem('examSubject', 'EXAMINATION');
                localStorage.setItem('examClass', 'RERSULT');
            }
            localStorage.setItem('examTerm', 'FIRST TERM 2025/2026');
             /*let username = sessionStorage.getItem('username');
             const userImage = sessionStorage.getItem('image');
            document.getElementById("usernameDisplay").innerText = "WELCOME:" + " " + username;
            document.getElementById('userImage').src = "img/student.png";
            document.getElementById('userName').innerText = username;
            document.getElementById('userImage').src = userImage;


            const username = sessionStorage.getItem('username') || 'Student';
            const userImageFile = sessionStorage.getItem('image');
            const userImagePath = userImageFile ? `img/${userImageFile}` : 'img/default_user.jpg';

            // Set username
            const usernameElements = [document.getElementById('userName'), document.getElementById('usernameDisplay')];
            usernameElements.forEach(el => { if(el) el.innerText = username; });

            // Set user image
            const userImageElement = document.getElementById('userImage');
            if(userImageElement){
                userImageElement.src = userImagePath;
                userImageElement.onerror = function(){
                    this.src = 'img/default_user.jpg'; // fallback if image not found
                };
            }*/
             const username = sessionStorage.getItem('username');
                const image = sessionStorage.getItem('image');

                if (!username) {
                  window.location.href = 'index.html';
                } else {
                  document.getElementById('username').innerText = username;
                  
              
                document.getElementById('userImage').src =
              'img/' + (sessionStorage.getItem('image') || 'default_user.jpg');
                }
           
            // Load static questions
            questions = staticObjectivesQuestions;
            theoryQuestions = staticTheoryQuestions;
           
            userAnswers = new Array(questions.length);
            theoryAnswers = new Array(theoryQuestions.length).fill('');
           
            updateDateTime();
            setInterval(updateDateTime, 1000);
           
            displayQuestion();
            renderQuestionButtons();
            countUserSelections();
            updateTheoryStatus();
        };
       
        // ================== TIMER ==================
        let timeLeft = 90 * 60; // 60 minutes
        const timerEl = document.getElementById('timer');
        const timerInterval = setInterval(() => {
            let min = Math.floor(timeLeft / 60);
            let sec = timeLeft % 60;
            timerEl.textContent = `Time Remaining: ${min}:minutes ${sec < 10 ? '0' + sec : sec} Seconds`;
            timeLeft--;
           
            // Change color when time is running out
            if (timeLeft < 300) { // 5 minutes
                timerEl.style.color = 'red';
                timerEl.style.animation = 'pulse 1s infinite';
            }
           
            if (timeLeft < 0) {
                clearInterval(timerInterval);
                alert("Time is up! Your exam will be submitted automatically.");
                submitExam();
            }
        }, 1000);
       
        // ================== SECTION TOGGLE ==================
        function showSection(section) {
            currentSection = section;
            // Update button states
            document.getElementById('objectivesBtn').classList.toggle('active', section === 'objectives');
            document.getElementById('theoryBtn').classList.toggle('active', section === 'theory');
           
            // Show/hide sections
            document.getElementById('objectivesSection').style.display = section === 'objectives' ? 'block' : 'none';
            document.getElementById('theorySection').style.display = section === 'theory' ? 'block' : 'none';
           
            // Update navigation
            if (section === 'theory') {
                displayTheoryQuestion();
            }
        }
       
        // ================== MATH SYMBOL MAPPING ==================
        function mapMathSymbol(text) {
            if (!text) return '';
           
            return text
                .replace(/&theta;/g, 'θ')
                .replace(/&Theta;/g, 'Θ')
                .replace(/&pi;/g, 'π')
                .replace(/&Pi;/g, 'Π')
                .replace(/&alpha;/g, 'α')
                .replace(/&beta;/g, 'β')
                .replace(/&gamma;/g, 'γ')
                .replace(/&delta;/g, 'δ')
                .replace(/&epsilon;/g, 'ε')
                .replace(/&phi;/g, 'φ')
                .replace(/&omega;/g, 'ω')
                .replace(/&mu;/g, 'μ')
                .replace(/&sigma;/g, 'σ')
                .replace(/&lambda;/g, 'λ')
                .replace(/&radic;/g, '√')
                .replace(/&infin;/g, '∞')
                .replace(/&int;/g, '∫')
                .replace(/&sum;/g, '∑')
                .replace(/&prod;/g, '∏')
                .replace(/&part;/g, '∂')
                .replace(/&deg;/g, '°')
                .replace(/&times;/g, '×')
                .replace(/&divide;/g, '÷')
                .replace(/&plusmn;/g, '±')
                .replace(/&le;/g, '≤')
                .replace(/&ge;/g, '≥')
                .replace(/&ne;/g, '≠')
                .replace(/&frac12;/g, '½')
                .replace(/&frac14;/g, '¼')
                .replace(/&frac34;/g, '¾')
                .replace(/\^(\d+)/g, '<sup>$1</sup>')
                .replace(/\^\(([^)]+)\)/g, '<sup>$1</sup>')
                .replace(/_(\d+)/g, '<sub>$1</sub>')
                .replace(/_\(([^)]+)\)/g, '<sub>$1</sub>');
        }
       
        // ================== OBJECTIVES FUNCTIONS ==================
        function saveAnswer() {
            const selected = document.querySelector('input[name="option"]:checked');
            if (selected) {
                userAnswers[currentQuestion] = selected.value;
                countUserSelections();
            }
        }
       
        function displayQuestion() {
            if (currentQuestion >= questions.length) return;
           
            const q = questions[currentQuestion];
           
            // Apply math symbol mapping
            const questionText = mapMathSymbol(q.question);
            const optA = mapMathSymbol(q.options.A);
            const optB = mapMathSymbol(q.options.B);
            const optC = mapMathSymbol(q.options.C);
            const optD = mapMathSymbol(q.options.D);
           
            // Display question and options
            document.getElementById('questionText').innerHTML = `${currentQuestion + 1}. ${questionText}`;
            document.getElementById('optA').innerHTML = optA;
            document.getElementById('optB').innerHTML = optB;
            document.getElementById('optC').innerHTML = optC;
            document.getElementById('optD').innerHTML = optD;
           
            // Handle question image
            const imageContainer = document.getElementById('questionImageContainer');
            if (q.image) {
                imageContainer.innerHTML = `
                    <div class="theory-image-wrapper">
                        <img src="${q.image}" alt="Question Diagram" class="question-image">
                    </div>
                `;
            } else {
                imageContainer.innerHTML = '';
            }
           
            // Clear and set radio buttons
            const radios = document.getElementsByName('option');
            radios.forEach(r => r.checked = false);
           
            if (userAnswers[currentQuestion]) {
                document.querySelector(`input[name="option"][value="${userAnswers[currentQuestion]}"]`).checked = true;
            }
           
            highlightCurrentButton();
        }
       
        function nextQuestion() {
            saveAnswer();
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                displayQuestion();
            }
        }
       
        function prevQuestion() {
            saveAnswer();
            if (currentQuestion > 0) {
                currentQuestion--;
                displayQuestion();
            }
        }
       
        function renderQuestionButtons() {
            const container = document.getElementById('questionButtons');
            container.innerHTML = '';
           
            for (let i = 0; i < questions.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'question-btn';
                btn.onclick = () => {
                    saveAnswer();
                    currentQuestion = i;
                    displayQuestion();
                };
                container.appendChild(btn);
            }
            highlightCurrentButton();
        }
       
        function highlightCurrentButton() {
            document.querySelectorAll('.question-btn').forEach((btn, index) => {
                const answered = userAnswers[index] !== undefined;
                const current = index === currentQuestion;
               
                btn.style.backgroundColor = current ? '#5cb85c' : (answered ? '#337ab7' : '#eee');
                btn.style.color = current || answered ? 'white' : 'black';
                btn.style.border = current ? '2px solid #2e7d32' : '1px solid #444';
            });
        }
       
        function countUserSelections() {
            let totalQuestions = questions.length;
            let answeredCount = userAnswers.filter(answer => answer !== undefined).length;
            let unansweredCount = totalQuestions - answeredCount;
           
            document.getElementById("answeredLabel").innerText = `Answered: ${answeredCount}/${totalQuestions}`;
            document.getElementById("unansweredLabel").innerText = `Unanswered: ${unansweredCount}`;
        }
       
        /*function submitExam() {
            saveAnswer();
            let score = 0;
            questions.forEach((q, i) => {
                if (userAnswers[i] === q.answer) score++;
            });
           
            clearInterval(timerInterval);
            alert(`Objective Exam Completed!\nYour Score: ${score} out of ${questions.length}`);
        }*/
         function submitExam() {
            saveAnswer();
            showResult();
        }
       
        /*function showResult() {
            clearInterval(timerInterval);
            let score = 0;
            questions.forEach((q, i) => {
                if (userAnswers[i] === q.answer) score++;
            });
           
            const username = localStorage.getItem("username") || "Guest";
            localStorage.setItem("examUser", username);
            localStorage.setItem("examScore", score);
            localStorage.setItem("totalQuestions", questions.length);


            // Save exam data before going to result page
            localStorage.setItem("student_name", username);
            localStorage.setItem("student_class", selectedClass);
            localStorage.setItem("exam_subject", selectedSubject);
            localStorage.setItem("student_image", studentImageURL);
            localStorage.setItem("exam_score", score);
            localStorage.setItem("total_questions", totalQuestions);

                // Redirect to results page
                window.location.href = "results.html";
           
            alert(`Objective Exam Completed!\nYour Score: ${score} out of ${questions.length}`);
            window.location.href = "results.html";
        }*/
        /*function showResult() {
            clearInterval(timerInterval);
            let score = 0;
            questions.forEach((q, i) => {
                if (userAnswers[i] === q.answer) score++;
            });
           
            const username = localStorage.getItem("username") || "Guest";
            const cls = sessionStorage.getItem("class");
            const sub = sessionStorage.getItem("subject");
           
            localStorage.setItem("examUser", username);
            localStorage.setItem("examScore", score);
            localStorage.setItem("totalQuestions", questions.length);
            localStorage.setItem("examInfo", document.getElementById('examInfo').textContent.trim());
           
            // ✅ Mark exam as completed
            if (cls && sub) {
                const attempts = getExamAttempts(cls);
                if (!attempts[username]) {
                    attempts[username] = {};
                }
                attempts[username][sub] = true;
                saveExamAttempts(cls, attempts);
            }
           
            alert(`Objective Exam Completed!\nYour Score: ${score} out of ${questions.length}`);
            window.location.href = "results.html";
    }*/
       function showResult() {
                    clearInterval(timerInterval);
                    let score = 0;
                    questions.forEach((q, i) => {
                        if (userAnswers[i] === q.answer) score++;
                    });
                   
                    const username = sessionStorage.getItem('username') || "Guest";
                    const cls = sessionStorage.getItem('class');
                    const sub = sessionStorage.getItem('subject');
                   
                    localStorage.setItem("examUser", username);
                    localStorage.setItem("examScore", score);
                    localStorage.setItem("totalQuestions", questions.length);
                    localStorage.setItem("pendingClass", cls);
                    localStorage.setItem("pendingSubject", sub);
                    localStorage.setItem("pendingUsername", username);
                   
                    // ✅ Get exam info from sessionStorage or use default
                    const examInfo = sessionStorage.getItem('examInfo') || 'EXAMINATION - RERSULT (FIRST TERM)';
                    localStorage.setItem("examInfo", examInfo);
                   
                    // ✅ DO NOT mark exam as completed here - wait for confirmation on results page
                    console.log(`Exam completed but not marked as attempted yet. Waiting for confirmation.`);
                   
                    alert(`Objective Exam Completed!\nYour Score: ${score} out of ${questions.length}\n\nClick OK to view your results and confirm your attempt.`);
                    window.location.href = "results.html";
        }

            // Add these helper functions to your exam page
            function getExamAttempts(cls) {
                const key = `${cls}_exam_attempts`;
                const stored = localStorage.getItem(key);
                return stored ? JSON.parse(stored) : {};
            }

            function saveExamAttempts(cls, data) {
                const key = `${cls}_exam_attempts`;
                localStorage.setItem(key, JSON.stringify(data));
            }
                   
        // ================== THEORY QUESTIONS ==================
        function displayTheoryQuestion() {
            if (theoryQuestions.length === 0) {
                document.getElementById('theoryQuestionText').innerText = "No theory questions available.";
                return;
            }
           
            const tq = theoryQuestions[currentTheory];
           
            // Display question text (without math symbol mapping for theory)
            document.getElementById('theoryQuestionText').innerText = mapMathSymbol(`${currentTheory + 1}. ${tq.question} ${tq.marks ? `[${tq.marks} marks]` : ''}`);
                
            document.getElementById('theoryAnswer').value = theoryAnswers[currentTheory] || "";
           
            // Handle theory question image
            const theoryImageContainer = document.getElementById('theoryImageContainer');
            if (tq.image) {
                theoryImageContainer.innerHTML = `
                    <div class="theory-image-wrapper">
                        <img src="${tq.image}" alt="Theory Question Diagram" class="theory-question-image">
                        <div class="image-caption">${tq.imageCaption || 'Diagram for question'}</div>
                    </div>
                `;
            } else {
                theoryImageContainer.innerHTML = '';
            }
           
            updateTheoryStatus();
        }
       
        function updateTheoryStatus() {
            const savedCount = theoryAnswers.filter(answer => answer.trim() !== "").length;
            document.getElementById("theoryStatus").innerText =
                `Question ${currentTheory + 1} of ${theoryQuestions.length} | Saved: ${savedCount}/${theoryQuestions.length}`;
        }
       
        function saveTheoryAnswer() {
            const answer = document.getElementById('theoryAnswer').value.trim();
            theoryAnswers[currentTheory] = answer;
            localStorage.setItem(`theoryAnswer_${currentTheory}`, answer);
            updateTheoryStatus();
            alert("Theory answer saved successfully!");
        }
       
        function nextTheoryQuestion() {
            if (currentTheory < theoryQuestions.length - 1) {
                currentTheory++;
                displayTheoryQuestion();
            } else {
                alert("You've reached the last theory question.");
            }
        }
       
        function prevTheoryQuestion() {
            if (currentTheory > 0) {
                currentTheory--;
                displayTheoryQuestion();
            }
        }
       
        function submitTheoryExam() {
            const savedCount = theoryAnswers.filter(answer => answer.trim() !== "").length;
            const confirmSubmit = confirm(
                `Theory section completed!\n\n` +
                `You have answered ${savedCount} out of ${theoryQuestions.length} theory questions.\n\n` +
                `Are you sure you want to submit?`
            );
           
            if (confirmSubmit) {
                alert("Theory answers submitted successfully!");
            }
        }
       
        // ================== DATE & TIME ==================
        function updateDateTime() {
            let now = new Date();
            let day = now.getDate();
            let month = now.toLocaleString('default', { month: 'long' });
            let year = now.getFullYear();
            let suffix = "th";
           
            if (day === 1 || day === 21 || day === 31) suffix = "st";
            else if (day === 2 || day === 22) suffix = "nd";
            else if (day === 3 || day === 23) suffix = "rd";
           
            let hours = now.getHours();
            let minutes = now.getMinutes();
            let seconds = now.getSeconds();
            let ampm = hours >= 12 ? "PM" : "AM";
            hours = hours % 12 || 12;
            minutes = minutes < 10 ? "0" + minutes : minutes;
            seconds = seconds < 10 ? "0" + seconds : seconds;
           
            let formattedDateTime = `${month} ${day}${suffix} ${year}, ${hours}:${minutes}:${seconds} ${ampm}`;
            document.getElementById("datetime").innerText = formattedDateTime;
        }
       
        // ================== KEYBOARD SHORTCUTS ==================
        document.addEventListener('keydown', function (event) {
            if (currentSection === 'objectives') {
                const key = event.key.toUpperCase();
               
                // Answer selection for objectives
                if (['A', 'B', 'C', 'D'].includes(key)) {
                    const radio = document.querySelector(`input[name="option"][value="${key}"]`);
                    if (radio) {
                        radio.checked = true;
                        saveAnswer();
                    }
                }
               
                // Navigation with arrows
                if (event.key === 'ArrowRight') {
                    nextQuestion();
                } else if (event.key === 'ArrowLeft') {
                    prevQuestion();
                }
            } else if (currentSection === 'theory') {
                // Navigation for theory
                if (event.key === 'ArrowRight') {
                    nextTheoryQuestion();
                } else if (event.key === 'ArrowLeft') {
                    prevTheoryQuestion();
                }
               
                // Save with Ctrl+S
                if (event.ctrlKey && event.key === 's') {
                    event.preventDefault();
                    saveTheoryAnswer();
                }
            }
        });
       
        // ================== ANTI-CHEAT & LOGOUT ==================
        document.addEventListener('keydown', function (event) {
            const key = event.key.toLowerCase();
            if ((event.ctrlKey && (key === 'p' || key === 's')) && currentSection === 'objectives') {
                event.preventDefault();
                alert("Right-click and view source are disabled during examination.");
                return false;
            }
        });
       
        document.addEventListener('contextmenu', (event) => {
            event.preventDefault();
            alert("Right-click is disabled during examination.");
        });
       
        document.addEventListener('keydown', function (e) {
            if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && e.key === 'I') ||
                (e.ctrlKey && e.shiftKey && e.key === 'J') || (e.ctrlKey && e.key === 'u')) {
                e.preventDefault();
                alert("Developer tools are disabled during examination.");
            }
        });
       
        function logout() {
            const confirmLogout = confirm("Are you sure you want to logout? Your progress may be lost.");
            if (confirmLogout) {
                window.location.href = "index.html";
            }
        }
    </script>
</body>
</html>
